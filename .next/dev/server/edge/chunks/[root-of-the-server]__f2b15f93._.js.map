{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\n\nconst ACCESS_KEY = process.env.BLOG_API_KEY || process.env.NEXT_PUBLIC_BLOG_KEY;\nconst COOKIE_NAME = \"blog-auth\";\nconst isProd = process.env.NODE_ENV === \"production\";\n\nexport function middleware(request: NextRequest) {\n  const { pathname, searchParams } = request.nextUrl;\n\n  if (!pathname.startsWith(\"/blog/editor\")) {\n    return NextResponse.next();\n  }\n\n  // In productie, daca nu exista cheie setata, editorul este blocat complet.\n  if (!ACCESS_KEY) {\n    if (isProd) {\n      return new NextResponse(\"Editor disabled in production. Set BLOG_API_KEY.\", { status: 401 });\n    }\n    return NextResponse.next();\n  }\n\n  const cookieValid = request.cookies.get(COOKIE_NAME)?.value === \"ok\";\n  const key = searchParams.get(\"key\");\n\n  // Allow and set cookie when key is provided correctly in the URL.\n  if (key && key === ACCESS_KEY) {\n    const response = NextResponse.next();\n    response.cookies.set({\n      name: COOKIE_NAME,\n      value: \"ok\",\n      httpOnly: true,\n      secure: true,\n      path: \"/blog/editor\",\n      maxAge: 60 * 60 * 24 * 30, // 30 days\n    });\n    return response;\n  }\n\n  if (cookieValid) {\n    return NextResponse.next();\n  }\n\n  return new NextResponse(\"Unauthorized. Add ?key=YOUR_KEY to the URL to authenticate.\", { status: 401 });\n}\n\nexport const config = {\n  matcher: [\"/blog/editor\"],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,YAAY,IAAI,QAAQ,GAAG,CAAC,oBAAoB;AAC/E,MAAM,cAAc;AACpB,MAAM,SAAS,oDAAyB;AAEjC,SAAS,WAAW,OAAoB;IAC7C,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,GAAG,QAAQ,OAAO;IAElD,IAAI,CAAC,SAAS,UAAU,CAAC,iBAAiB;QACxC,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,2EAA2E;IAC3E,IAAI,CAAC,YAAY;QACf;;QAGA,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,MAAM,cAAc,QAAQ,OAAO,CAAC,GAAG,CAAC,cAAc,UAAU;IAChE,MAAM,MAAM,aAAa,GAAG,CAAC;IAE7B,kEAAkE;IAClE,IAAI,OAAO,QAAQ,YAAY;QAC7B,MAAM,WAAW,gMAAY,CAAC,IAAI;QAClC,SAAS,OAAO,CAAC,GAAG,CAAC;YACnB,MAAM;YACN,OAAO;YACP,UAAU;YACV,QAAQ;YACR,MAAM;YACN,QAAQ,KAAK,KAAK,KAAK;QACzB;QACA,OAAO;IACT;IAEA,IAAI,aAAa;QACf,OAAO,gMAAY,CAAC,IAAI;IAC1B;IAEA,OAAO,IAAI,gMAAY,CAAC,+DAA+D;QAAE,QAAQ;IAAI;AACvG;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAe;AAC3B"}}]
}